# **LeetCode 121\. Best Time to Buy and Sell Stock**

## **1\. 題目概述**

這道題目要求我們在一組代表股票每日價格的數組 prices 中，找到一個「買入日」與一個「賣出日」（賣出必須在買入之後），使得賣出價格減去買入價格的利潤最大化。如果無法獲得利潤，則回傳 0。

### **測驗目的**

這道題目主要測試開發者對於以下概念的掌握：

* **數組遍歷（Array Traversal）**：如何高效地讀取數組數據。  
* **動態維護狀態（Dynamic State Maintenance）**：在遍歷過程中即時更新當前的「最低點」與「最大利潤」。  
* **時間與空間複雜度優化**：能否避開暴力解法的 $O(n^2)$，轉向更優 $O(n)$ 線性解法。

## **2\. 思路邏輯分析**

### **關鍵觀察**

從題目敘述中，我們可以推導出三個核心邏輯：

1. **時間順序性**：你必須先買入才能賣出。這意味著當我們考慮某一天為「賣出日」時，我們只需要知道在那天之前的「最低買入價」是多少。  
2. **貪心思想（Greedy Approach）**：為了讓利潤最大，我們希望在「歷史最低點」買入，並在「其後的最高點」賣出。  
3. **時間複雜度判斷**：從題目給定的限制條件（Constraints）來看，prices.length 最高可達 $10^5$。在面試或競賽環境（如 LeetCode）中，評測系統通常設定單個測資的執行時間上限為 **1 秒**。根據經驗法則，電腦每秒約可執行 $10^8$ 次基本運算（Operations）。若時間複雜度為 $O(n^2)$，當 $n \= 10^5$ 時運算量將達到 $10^{10}$，遠超 1 秒的處理能力，這會導致超時（Time Limit Exceeded, TLE）。因此，這暗示我們必須尋找 $O(n)$ 或 $O(n \\log n)$ 的解法。

### **思考路徑**

* **暴力法（Brute Force）**：檢查每一對可能的買入與賣出組合。  
  * 邏輯：兩層迴圈，外層選買入日，內層選賣出日。  
  * 缺點：時間複雜度為 $O(n^2)$，當 prices 長度達到 $10^5$ 時會造成超時（TLE）。  
* **優化法（One Pass）**：  
  * 既然我們只能由左往右（時間順序）看，我們可以在遍歷時順便記住到目前為止看到的「最低價格」。  
  * 對於每一天的價格，我們都假設在今天賣出，那麼利潤就是 今天價格 \- 歷史最低價格。  
  * 不斷更新這個「最大利潤」即可。  
  * **複雜度壓制與計算**：透過此方法，時間複雜度可以從 $O(n^2)$ 壓制到 $O(n)$。這是因為我們只對數組進行了「單次掃描」，每個元素僅被訪問一次，且在訪問時執行的「更新最小值」與「計算利潤」均為 $O(1)$ 的常數操作，因此總執行時間與 $n$ 成線性比例。

## **3\. 總結**

本題的精髓在於**不需要回頭看**。只要我們能持續追蹤當前的最低買入點，就能在一次掃描中計算出所有可能的最佳賣出時機。這是處理流式數據或時間序列數據時非常重要的一個技巧。
